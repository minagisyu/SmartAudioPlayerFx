
□□ SmartAudioPlayer Fx □□□□□□□□□□□□□□□□□□□□□□□□

タイトルバーサイズの小さなオーディオプレーヤーです。
特定フォルダ内の音楽を垂れ流しする用途に特化して作られてます。


□□ インストール＆アンインストール □□□□□□□□□□□□□□□□□□□

アーカイブ内のファイルを解凍するだけでOKです。

動作には Microsoft .NET Framework 4 Client Profileが必要です。
フルバージョンの.NET Framework 4にはClient Profileが含まれています。
http://msdn.microsoft.com/ja-jp/netframework/ff687189.aspx

アンインストールするにはファイルの削除だけで大丈夫ですが、
追加されたWindowsMediaPlayerの設定(レジストリ内)が気になる方は以下の場所を編集してください。
HKEY_CURRENT_USER\Software\Microsoft\MediaPlayer\Player\Extensions

設定ファイルやエラーログは以下の場所に保存されています。
＜ユーザー名＞\AppData\Roaming\SmartAudioPlayer Fx


□□ アップデートについて □□□□□□□□□□□□□□□□□□□□□□□□

アップデート処理を行う際に作業用としてユーザーフォルダ内のTempフォルダを使用します。
正常に完了すれば削除されるはずですが、残っていたら削除しても大丈夫です。
例) C:\Users\(ユーザー名)\AppData\Local\Temp\sap_update_xxxxxxxx

また、アップデート中に上書きされたファイルに関してはバックアップを取ってあります。
もし問題が起きたら、previous version内のファイルで上書きコピーすると以前のバージョンに戻せます。
こちらも不要であれば削除しても大丈夫です。


□□ FAQ的な何か □□□□□□□□□□□□□□□□□□□□□□□□□□□□□

◆アプリケーション
・拡張子追加しても再生出来ない
  - 拡張子の追加はファイル検索の対象になるだけです。
  - WindowsMediaPlayerで再生出来るものは再生出来るはず。
  - DirectShowのフィルタをインストールすると色々再生出来ます。↓一番のオススメはLAV Filters
  - LAV Filters: http://forum.doom9.org/showthread.php?t=156191
  - ffdshow tryouts: http://ffdshow-tryout.sourceforge.net/
  - CCCP: http://www.cccp-project.net/

 ・再生させた瞬間アプリケーションがクラッシュする
   - 何かのDirectShowフィルタが悪さをしている予感
   - フィルタのメリット値を変えたり無効にしたり登録解除して試してみてください
    - 登録解除の例） regsvr32 /u フィルタファイル名
   - ライティングソフトやDVD/Blu-ray再生ソフトウェア、地デジチューナー等が怪しいかも？
   - FLVの再生時にクラッシュする問題は以下のフィルタが怪しい
    - PowerDVDのCyberLink FLV Splitter (CLFLVSplitter.ax)
    - B's Recorder GOLDのMainConcept MPEG Splitter (mcspmpeg.ax)

◆メディアライブラリ ウィンドウ
・検索の仕様について
  - ファイルパス、タイトル名、アーティスト名、アルバム名、コメントから単語検索しています
  - 検索ワードは大文字/小文字、全角/半角の区別なしです。(ただし漢字除く)
  - AND検索しか出来ません

・「最近追加」リストって？
  - 現在からn日前までに追加された項目が表示されるリストです
  - 日数はデフォルトで60日、オプションで変更可能です

・リストの背景色の意味は？
  - 黄: ファイル作成日が最近のもの。7日単位4段階で薄くなります。
  - 青: 現在再生中
  - 緑: リスト選択中
  - 灰: リストカーソル
  - 赤: 再生エラー

・リストの★マークは何？
  - お気に入りです。「お気に入り」リストに表示されるようになります。

・リストの左にある四角いアイコンは何？
  - 再生情報とコメント表示用です。コメントがあると濃い色になります。


□□ 即知のバグ的なもの □□□□□□□□□□□□□□□□□□□□□□□□□□

◆アプリケーション
・終了を選んでも一度で終了出来ない
  - 原因調査中。

・曲が再生しているようだが、音が聞こえない
  - 原因調査中。一時停止→再生したり、ボリュームを弄ると音が鳴る
  - ゲームの改造対策ソフトが原因で音声出力に異常が発生する場合もあるようです

・MIDIファイルを途中から再生(再生中にアプリケーションを終了し、再度起動)した状態で曲をスキップすると落ちる
  - 原因調査中。環境依存っぽい？
  - もし発生してしまった場合はplayer.xmlを削除するか「CurrentMedia=""」の記述を削除し、
    midiファイルを再生しないようにしてください。

◆メディアライブラリ ウィンドウ
・現在再生曲のタイトルをクリックしても表示範囲までスクロールしない
  - 原因調査中。WPF内部の状況によって発生したりしなかったりする。

・ツリーの表示が不完全。(必要なツリーがなかったり、不要なツリーが存在する)
  - ツリー項目の作成にバグがあります。ごめんなさい。
  - エクスプローラでファイル操作したりして動的な更新が起きると発生しやすい。
  - DB上に「削除済み」とマークされた項目が「復活」(同じパスにファイルが存在)すると発生しやすい。
  - 同じフォルダを何度か開き直すと正常なツリーが生成されます。


□□ ライブラリについて □□□□□□□□□□□□□□□□□□□□□□□□□□

mp3infp
  ** http://win32lab.com/fsw/mp3infp/
  ** 掲示板で配布されている有志によるアップデート版を同梱しています

Windows API Code Pack for Microsoft .NET Framework
  ** http://archive.msdn.microsoft.com/WindowsAPICodePack

Expression Blend SDK for .NET 4
  ** http://www.microsoft.com/downloads/ja-jp/details.aspx?FamilyID=75e13d71-7c53-4382-9592-6c07c6a00207

Async Targeting Pack for Visual Studio 2012
  ** http://www.microsoft.com/en-us/download/details.aspx?id=29576

DotNetZip Library
  ** http://dotnetzip.codeplex.com/

System.Data.SQLite
  ** http://sqlite.phxsoftware.com/

Reactive Extensions
  ** http://msdn.microsoft.com/en-us/data/gg577609

Interactive Extensions
  ** http://www.microsoft.com/download/en/details.aspx?id=27203

ReactiveProperty
  ** http://reactiveproperty.codeplex.com/

DbExecutor
  ** http://dbexecutor.codeplex.com/

Diagona Icons
  ** Copyright (C) 2007 Yusuke Kamiyamane. All rights reserved.
  ** The icons are licensed under a Creative Commons Attribution3.0 license.
  ** <http://creativecommons.org/licenses/by/3.0/>
  ** http://p.yusukekamiyamane.com/


□□ ライセンス＆再配布について □□□□□□□□□□□□□□□□□□□□□□

SmartAudioPlayer Fxはパブリックドメイン扱いとします。
同梱されているライブラリやアイコンの扱いに関してはそのライセンスに従ってください。

また、このプログラムは無保証であるがままに提供されています。
プログラムによって生じたいかなる損害も補償する義務を負いません。


□ バージョン履歴 □□□□□□□□□□□□□□□□□□□□□□□□□□□□□

3.3.0.2 - 2012/06/16
◆アプリケーション
・多重起動を判定するタイミングの問題で自動アップデートに失敗する問題を修正
  - チェックが甘くてすみません...

3.3.0.1 - 2012/06/16
◆アプリケーション
・ライブラリを更新
・アプリケーションの署名をやめた
  - 一部ライブラリに署名が無く組み込めないためです
・処理を全般的に書き直した
  - 履歴に書ききれていない変更もあると思いますが思い出せません...
◆プレーヤーウィンドウ
・一部のキーショートカットが効かないバグを修正
・ウィンドウの最小サイズに制限をつけた
・ウィンドウの位置を保存・復元するのにWindowPlacement APIを使用するようにした
◆メディアライブラリ ウィンドウ
・「ファイルの保存場所を開く」が正常に動作しないバグを修正
・ツリーが正確に生成されないバグを修正
・フォルダ直下のファイルアイテムが表示されないバグを修正
・特殊ツリー項目[すべて]を追加
・特殊ツリー項目[最近追加]で表示される日数をオプションで変更できるようにした
・特殊ツリー項目の表示条件でツリーを表示できるようにした
　- ツリー項目右側のボタンで切り替えます
　- ツリーに表示されている内容が再生時に選択されるファイルとなります

3.2.0.3
◆アプリケーション
・mp3infp.dll使用時に不正なメモリにアクセスする可能性のあるバグを修正
◆プレーヤーウィンドウ
・ドラッグ移動時にウィンドウ端にも吸着するようにした

3.2.0.2
◆アプリケーション
・Reactive Extensions v1.0.2787.104に差し替え
・アプリケーションの更新チェックを選択に出来るようにした
・再生中のファイルが消失した状態で起動すると異常終了する問題を修正
・ボリュームのフェードエフェクト発生時に無音になるバグを暫定修正
・Vistaで「フォルダを開く」ダイアログを表示させたとき、存在しないフォルダを開こうとするバグを修正
  - (Windows 7では発生しない謎バグ...)
・その他微修正
◆プレーヤーウィンドウ
・ウィンドウをドラッグ(移動やリサイズ)中にウィンドウが描画されないバグを修正
  - (WS_EX_NOACTIVATEスタイルをつけると発生するWindowsの不思議仕様らしい...)
◆メディアライブラリ ウィンドウ
・「ファイルの保存場所を開く」でファイルパスに「,」が付いているときに正しく開けなかったバグを修正
・ツリー項目の動的生成・削除がうまく機能しないバグを暫定修正

3.2.0.1
◆アプリケーション
・「ビデオを描画する」をメディアライブラリ側へ移動
・ボリュームのフェードエフェクトを無効にできるようにした
◆メディアライブラリ ウィンドウ
・タイトルの代わりにファイル名を表示できるようにした
・非アクティブ時に自動でウィンドウを閉じれるようにした
・リスト項目ダブルクリックで再生時に自動でウィンドウを閉じれるようにした

3.2.0.0
◆アプリケーション
・mp3infp.dllを2.54i/u6(32bit版)に差し替え
・Windows API Code Pack v1.1 公式ビルド版に差し替え
・Reactive Extensions v1.0.2698.0に差し替え
・ファイルスキャン後にアプリケーションが例外落ちする場合がある問題を修正
・その他微修正
◆メディアライブラリ ウィンドウ
・コメント及びお気に入りスターにカーソルを当てたときにカーソルアイコンを変更するようにした

3.1.0.7
◆アプリケーション
・起動時に例外落ちする場合がある問題を修正
・アップデートファイルのダウンロードに失敗した際に例外が発生する問題を修正
・ログオフ時に設定が保存されない場合がある問題を修正

3.1.0.6
◆アプリケーション
・アップデート中にファイルコピーが正常に行われない可能性がある問題を修正
・アップデートファイルをダウンロードするだけのオプションを追加
・アップデートファイルの破損していた場合に再試行出来るようにした
◆メディアライブラリ ウィンドウ
・動画再生時にビデオをウィンドウ背景に描画する機能を追加
  ([メニュー > ビデオを描画する]でオンオフ可能、デフォルト:オン)

3.1.0.5
◆アプリケーション
・アップデート中に例外エラーが発生する問題を修正
・終了処理が発動しない場合がある問題を修正
・再生直後に内部ボリュームが無音になる問題を暫定修正

3.1.0.4
◆アプリケーション
・設定ファイルの位置をAppData内に変更
◆メディアライブラリ ウィンドウ
・削除扱いのアイテムが表示される問題を再修正

3.1.0.3
◆メディアライブラリ ウィンドウ
・ツリーに追加/削除があるときにアプリケーションがクラッシュする問題を修正

3.1.0.2
◆アプリケーション
・内部処理の最適化を行いました
  (もしかしたら多少不安定になっている可能性も...)

3.1.0.1
◆アプリケーション
・存在しないフォルダをオープンした際にクラッシュする問題を修正
・DB更新処理が正常に動作しない可能性があった問題を修正
・内部処理の最適化を行いました
◆メディアライブラリ ウィンドウ
・削除扱いのアイテムが表示される問題を修正

3.1.0.0
◆アプリケーション
・ライブラリ更新のキャンセルが効かなかった問題を修正
・ファイル名順再生モード時に正しくない順番で再生されていた問題を修正
・mp3infp.dllのバージョンを2.54i/u3に変更
・内部処理の最適化を行いました
◆メディアライブラリ ウィンドウ
・タイトルやアーティスト名などをコピー出来るようにしてみた

3.0.19.3
◆アプリケーション
・手動アップデート時に新しい更新がないときにメッセージを出すようにした
・フォルダの監視機能を実装しました
  - 開いたフォルダに対するファイルの追加・削除が自動で行われます
  - ファイルのリネームは新規追加扱いです
◆メディアライブラリ ウィンドウ
・オプションを閉じたあとにツリーをリセットしないようにしました
・タグ情報の編集ダイアログを出せるようにしてみた
・右クリックメニューからファイル(フォルダ)の無視が出来るようにしてみた

3.0.19.2
◆アプリケーション
・終了時に設定を保存しない問題を修正

3.0.19.1
◆アプリケーション
・更新機能を実装
  - 以前のバージョンは「previous version」フォルダにバックアップされます
◆プレーヤー ウィンドウ
・現在再生曲の情報が更新されても表示が更新されなかった問題を修正
◆メディアライブラリ ウィンドウ
・ウィンドウ内部を再構成して処理を軽くしてみた
・タイトルが長すぎる場合に☆が見えなくなるのを修正
・コメント表示でアルバム名を表示していた問題を修正
・現在再生曲にジャンプする際に、リストがスクロールしない問題を修正
・無視ワードに合致する曲が特定条件でリスト内に追加される問題を修正
・メディア再生情報の実装
  - コメント表示アイコンにマウスを置くと、再生回数やスキップ回数などが表示されます
・特殊検索ツリーを実装
  - お気に入り、未再生、最近追加(14日前までに追加)をつけてみた
 

□□ Webサイト □□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□

イントレ。
http://intre.net/
